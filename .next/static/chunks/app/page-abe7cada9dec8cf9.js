(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3154:function(e,a,s){Promise.resolve().then(s.bind(s,5236))},5236:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return U}});var t=s(7437),l=s(2265),r=s(3145),n=s(9474),i=s(1817),d=s(7806),c=s(7692),o=s(9090),x=s(6937),m=s(5621),h=s(3245),g=s(8774);let u=e=>{var a;let{children:s,activeTab:l,onTabChange:u,onOpenAddPlayer:p,onOpenLogMatch:f}=e,{user:b,loading:j,signIn:y,signOutUser:N}=(0,g.a)();return(0,t.jsxs)("div",{className:"h-screen bg-gray-50 flex flex-col max-w-md mx-auto shadow-2xl relative",children:[(0,t.jsxs)("header",{className:"bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center sticky top-0 z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"bg-emerald-600 text-white p-1.5 rounded-lg",children:(0,t.jsx)(n.Z,{className:"w-5 h-5"})}),(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"PongRank"})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:j?(0,t.jsx)(i.Z,{className:"w-5 h-5 animate-spin text-gray-400"}):b?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[b.photoURL&&(0,t.jsx)(r.default,{src:b.photoURL,alt:b.displayName||"User",width:32,height:32,className:"rounded-full"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700 hidden sm:block max-w-[100px] truncate",children:null===(a=b.displayName)||void 0===a?void 0:a.split(" ")[0]})]}),(0,t.jsx)("button",{onClick:p,className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-full transition-colors","aria-label":"Add Player",children:(0,t.jsx)(d.Z,{className:"w-5 h-5"})}),(0,t.jsx)("button",{onClick:N,className:"p-2 text-gray-400 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Sign Out",children:(0,t.jsx)(c.Z,{className:"w-5 h-5"})})]}):(0,t.jsxs)("button",{onClick:y,className:"flex items-center gap-2 px-3 py-2 bg-emerald-600 text-white rounded-lg text-sm font-medium hover:bg-emerald-700 transition-colors",children:[(0,t.jsx)(o.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Sign In"})]})})]}),(0,t.jsx)("main",{className:"flex-1 overflow-y-auto px-4 py-6 no-scrollbar relative",children:s}),b&&(0,t.jsx)("div",{className:"absolute bottom-24 right-6 z-20",children:(0,t.jsx)("button",{onClick:f,className:"bg-emerald-600 hover:bg-emerald-700 text-white p-4 rounded-full shadow-lg shadow-emerald-600/30 transition-all active:scale-95 flex items-center justify-center",children:(0,t.jsx)(x.Z,{className:"w-8 h-8"})})}),(0,t.jsxs)("nav",{className:"bg-white border-t border-gray-200 px-6 py-3 flex justify-between items-center pb-safe shrink-0",children:[(0,t.jsxs)("button",{onClick:()=>u("leaderboard"),className:"flex flex-col items-center gap-1 transition-colors ".concat("leaderboard"===l?"text-emerald-600":"text-gray-400 hover:text-gray-600"),children:[(0,t.jsx)(n.Z,{className:"w-6 h-6"}),(0,t.jsx)("span",{className:"text-[10px] font-medium uppercase tracking-wide",children:"Rankings"})]}),(0,t.jsxs)("button",{onClick:()=>u("history"),className:"flex flex-col items-center gap-1 transition-colors ".concat("history"===l?"text-emerald-600":"text-gray-400 hover:text-gray-600"),children:[(0,t.jsx)(m.Z,{className:"w-6 h-6"}),(0,t.jsx)("span",{className:"text-[10px] font-medium uppercase tracking-wide",children:"History"})]}),(0,t.jsxs)("button",{onClick:()=>u("info"),className:"flex flex-col items-center gap-1 transition-colors ".concat("info"===l?"text-emerald-600":"text-gray-400 hover:text-gray-600"),children:[(0,t.jsx)(h.Z,{className:"w-6 h-6"}),(0,t.jsx)("span",{className:"text-[10px] font-medium uppercase tracking-wide",children:"Rules"})]})]})]})},p=e=>{let{players:a}=e,s=[...a].sort((e,a)=>a.elo-e.elo);return 0===a.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center px-4",children:[(0,t.jsx)(n.Z,{className:"w-12 h-12 text-gray-300 mb-3"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"No Players Yet"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Sign in and add players to start tracking the ranks!"})]}):(0,t.jsxs)("div",{className:"flex flex-col gap-4 pb-20",children:[(0,t.jsxs)("div",{className:"bg-emerald-600 p-6 rounded-2xl text-white shadow-xl shadow-emerald-200 mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,t.jsx)(n.Z,{className:"w-5 h-5 text-yellow-300"}),(0,t.jsx)("span",{className:"text-emerald-100 font-medium text-sm uppercase tracking-wider",children:"Current Champion"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[s[0].photoURL&&(0,t.jsx)(r.default,{src:s[0].photoURL,alt:s[0].name,width:48,height:48,className:"rounded-full border-2 border-white/30"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-3xl font-bold",children:s[0].name}),(0,t.jsxs)("div",{className:"text-emerald-100 opacity-90",children:[s[0].elo," Elo"]})]})]})]}),(0,t.jsx)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-100",children:[(0,t.jsx)("th",{className:"py-3 px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider w-12 text-center",children:"#"}),(0,t.jsx)("th",{className:"py-3 px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Player"}),(0,t.jsx)("th",{className:"py-3 px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider text-right",children:"Rating"}),(0,t.jsx)("th",{className:"py-3 px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider text-right",children:"W-L"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-50",children:s.map((e,a)=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,t.jsx)("td",{className:"py-3 px-4 text-center font-medium text-gray-400",children:a+1}),(0,t.jsx)("td",{className:"py-3 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.photoURL&&(0,t.jsx)(r.default,{src:e.photoURL,alt:e.name,width:28,height:28,className:"rounded-full"}),(0,t.jsx)("div",{className:"font-medium text-gray-900",children:e.name})]})}),(0,t.jsx)("td",{className:"py-3 px-4 text-right",children:(0,t.jsx)("span",{className:"font-semibold text-emerald-700 bg-emerald-50 px-2 py-1 rounded-md text-sm",children:e.elo})}),(0,t.jsxs)("td",{className:"py-3 px-4 text-right text-sm text-gray-500",children:[e.wins,"-",e.losses]})]},e.id))})]})})})]})};var f=s(1047),b=s(6362),j=s(525);let y=e=>{let{matches:a,players:s}=e,l=e=>{var a;let t=String(e);return(null===(a=s.find(e=>String(e.id)===t))||void 0===a?void 0:a.name)||"Unknown"};if(!a||0===a.length)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center px-4",children:[(0,t.jsx)(f.Z,{className:"w-12 h-12 text-gray-300 mb-3"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"No Matches Yet"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Log your first match to see history here."})]});let r=[...a].sort((e,a)=>new Date(a.date).getTime()-new Date(e.date).getTime());return(0,t.jsx)("div",{className:"flex flex-col gap-4 pb-4",children:r.map(e=>{let a="No date";if(e.date){let s=new Date(e.date);isNaN(s.getTime())||(a=s.toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))}let s=e.winnerIds||[],r=e.loserIds||[],n=s.map(l).join(" & "),i=r.map(l).join(" & "),d=e.score||"-",c=e.eloChange||0;return(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{className:"text-xs font-medium text-gray-400 uppercase tracking-wide flex items-center gap-1.5",children:[(0,t.jsx)(f.Z,{className:"w-3 h-3"}),a]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs font-medium rounded-full",children:"DOUBLES"===e.type?"Doubles":"Singles"}),e.txHash&&(0,t.jsx)("a",{href:"https://sepolia.etherscan.io/tx/".concat(e.txHash),target:"_blank",rel:"noopener noreferrer",className:"p-1 text-blue-500 hover:bg-blue-50 rounded transition-colors",title:"View on Etherscan",children:(0,t.jsx)(b.Z,{className:"w-3 h-3"})})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("div",{className:"font-semibold text-gray-900 truncate",children:n}),(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500 shrink-0"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"font-normal text-gray-500 truncate",children:i}),(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-red-400 shrink-0"})]})]}),(0,t.jsxs)("div",{className:"text-right shrink-0",children:[(0,t.jsx)("div",{className:"text-lg font-bold text-gray-900",children:d}),c>0&&(0,t.jsxs)("div",{className:"text-xs font-medium text-emerald-600 flex items-center justify-end gap-1",children:[(0,t.jsx)(j.Z,{className:"w-3 h-3"}),c," Elo"]})]})]})]},e.id)})})};var N=s(8906);let w=()=>(0,t.jsxs)("div",{className:"space-y-6 pb-20",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"How it works"}),(0,t.jsxs)("p",{className:"text-gray-600 leading-relaxed mb-4",children:["The Elo rating system calculates the relative skill levels of players. Everyone starts at ",(0,t.jsx)("strong",{children:"1200"}),"."]}),(0,t.jsxs)("ul",{className:"space-y-3 text-sm text-gray-600",children:[(0,t.jsxs)("li",{className:"flex gap-2",children:[(0,t.jsx)("span",{className:"text-emerald-500 font-bold",children:"•"}),(0,t.jsxs)("span",{children:["Beat a higher-rated player? Gain ",(0,t.jsx)("strong",{children:"more"})," points."]})]}),(0,t.jsxs)("li",{className:"flex gap-2",children:[(0,t.jsx)("span",{className:"text-emerald-500 font-bold",children:"•"}),(0,t.jsxs)("span",{children:["Beat a lower-rated player? Gain ",(0,t.jsx)("strong",{children:"fewer"})," points."]})]}),(0,t.jsxs)("li",{className:"flex gap-2",children:[(0,t.jsx)("span",{className:"text-red-500 font-bold",children:"•"}),(0,t.jsxs)("span",{children:["Lose to a lower-rated player? Lose ",(0,t.jsx)("strong",{children:"more"})," points."]})]})]})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-700 rounded-2xl p-6 text-white shadow-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(N.Z,{className:"w-5 h-5"}),(0,t.jsx)("h4",{className:"font-bold",children:"Blockchain Verified"})]}),(0,t.jsx)("p",{className:"text-blue-100 text-sm mb-4",children:"All matches and ELO changes are permanently recorded on the Ethereum Sepolia testnet. This means your rankings can't be tampered with!"}),(0,t.jsxs)("a",{href:"https://sepolia.etherscan.io",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-white/80 hover:text-white transition-colors",children:[(0,t.jsx)(b.Z,{className:"w-4 h-4"}),"View on Etherscan"]})]}),(0,t.jsxs)("div",{className:"bg-gray-900 rounded-2xl p-6 text-gray-300 font-mono text-sm shadow-lg",children:[(0,t.jsx)("h4",{className:"text-white font-bold mb-3 font-sans",children:"The Math"}),(0,t.jsxs)("div",{className:"space-y-2 opacity-80",children:[(0,t.jsx)("p",{children:"K = 32"}),(0,t.jsx)("p",{children:"Expected = 1 / (1 + 10^((EloB - EloA) / 400))"}),(0,t.jsx)("p",{className:"text-emerald-400",children:"Change = K * (1 - Expected)"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"Sign In with Google"}),(0,t.jsx)("p",{className:"text-gray-600 leading-relaxed text-sm",children:"Sign in with your Google account to add players and log matches. Your profile picture and name will be shown on the leaderboard. All blockchain transactions are handled automatically—no crypto knowledge required!"})]})]}),v=e=>{let{children:a,variant:s="primary",fullWidth:l=!1,className:r="",...n}=e;return(0,t.jsx)("button",{className:"".concat("px-4 py-3 rounded-xl font-medium transition-all active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base"," ").concat({primary:"bg-emerald-600 text-white hover:bg-emerald-700 shadow-lg shadow-emerald-200",secondary:"bg-white text-gray-800 border border-gray-200 hover:bg-gray-50 shadow-sm",danger:"bg-red-50 text-red-600 border border-red-100 hover:bg-red-100",ghost:"bg-transparent text-gray-500 hover:bg-gray-100"}[s]," ").concat(l?"w-full":""," ").concat(r),...n,children:a})},k=e=>{let{label:a,className:s="",...l}=e;return(0,t.jsxs)("div",{className:"flex flex-col gap-1.5 w-full",children:[a&&(0,t.jsx)("label",{className:"text-sm font-medium text-gray-700",children:a}),(0,t.jsx)("input",{className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all ".concat(s),...l})]})};var S=s(9388),C=s(8837),E=s(1671);let Z=[],L=[];async function P(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,t={"Content-Type":"application/json"};s&&(t.Authorization="Bearer ".concat(s));try{let s=await fetch(e,{...a,headers:t}),l=await s.json();if(!s.ok)throw Error(l.error||"Request failed");return l}catch(e){throw console.error("API call failed:",e),e}}async function T(){try{var e,a;let[s,t]=await Promise.all([P("/api/players"),P("/api/matches")]),l=(null===(e=s.data)||void 0===e?void 0:e.players)||[],r=(null===(a=t.data)||void 0===a?void 0:a.matches)||[];return Z=l,L=r,{players:l,matches:r}}catch(e){return console.error("Failed to fetch data:",e),{players:Z,matches:L}}}async function R(e,a){var s;let t=null===(s=(await P("/api/players",{method:"POST",body:JSON.stringify({name:e})},a)).data)||void 0===s?void 0:s.player;if(!t)throw Error("Failed to create player");return Z=[...Z,t],t}async function D(e,a,s,t,l){var r;let n=null===(r=(await P("/api/matches",{method:"POST",body:JSON.stringify({type:e,winnerIds:a,loserIds:s,score:t})},l)).data)||void 0===r?void 0:r.match;if(!n)throw Error("Failed to log match");return L=[...L,n],Z=Z.map(e=>a.includes(e.id)?{...e,elo:e.elo+n.eloChange,wins:e.wins+1}:s.includes(e.id)?{...e,elo:e.elo-n.eloChange,losses:e.losses+1}:e),n}let I=e=>{let{players:a,onMatchLogged:s,onCancel:r}=e,{getToken:c,user:o}=(0,g.a)(),[x,m]=(0,l.useState)("SINGLES"),[h,u]=(0,l.useState)([]),[p,f]=(0,l.useState)([]),[b,j]=(0,l.useState)(""),[y,N]=(0,l.useState)(1),[w,Z]=(0,l.useState)(null),[L,P]=(0,l.useState)(!1),[T,R]=(0,l.useState)("idle"),I=(e,a)=>{a&&p.includes(e)&&f(a=>a.filter(a=>a!==e)),!a&&h.includes(e)&&u(a=>a.filter(a=>a!==e));let s=a?u:f,t=a?h:p;if(t.includes(e))s(a=>a.filter(a=>a!==e));else{let a="SINGLES"===x?1:2;t.length<a&&s(a=>[...a,e])}},G=()=>{let e="SINGLES"===x?1:2;return h.length!==e||p.length!==e?(Z("Select ".concat(e," winner").concat(e>1?"s":""," and ").concat(e," loser").concat(e>1?"s":"",".")),!1):(Z(null),!0)},U=async()=>{if(!b.trim()){Z("Please enter a valid score (e.g., 11-9)");return}if(!o){Z("You must be signed in to log matches");return}P(!0),R("pending"),Z(null);try{let e=await c();if(!e)throw Error("Failed to get authentication token");await D(x,h,p,b,e),R("confirmed"),setTimeout(()=>{s()},1500)}catch(e){Z(e.message||"Failed to log match. Please try again."),R("idle"),P(!1)}};return o?a.length<2?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center bg-white rounded-2xl shadow-sm",children:[(0,t.jsx)(d.Z,{className:"w-12 h-12 text-gray-300 mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"You need at least 2 players to log a match."}),(0,t.jsx)(v,{onClick:r,children:"Go Back"})]}):1===y?(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Select Match Type"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("button",{onClick:()=>m("SINGLES"),className:"p-6 rounded-2xl border-2 text-center transition-all ".concat("SINGLES"===x?"border-emerald-500 bg-emerald-50 text-emerald-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"),children:[(0,t.jsx)("div",{className:"text-3xl mb-2",children:"\uD83D\uDC64"}),(0,t.jsx)("div",{className:"font-semibold",children:"Singles"})]}),(0,t.jsxs)("button",{onClick:()=>m("DOUBLES"),className:"p-6 rounded-2xl border-2 text-center transition-all ".concat("DOUBLES"===x?"border-emerald-500 bg-emerald-50 text-emerald-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"),children:[(0,t.jsx)("div",{className:"text-3xl mb-2",children:"\uD83D\uDC65"}),(0,t.jsx)("div",{className:"font-semibold",children:"Doubles"})]})]}),(0,t.jsxs)("div",{className:"mt-auto pt-6 flex gap-3",children:[(0,t.jsx)(v,{variant:"ghost",className:"flex-1",onClick:r,children:"Cancel"}),(0,t.jsx)(v,{className:"flex-1",onClick:()=>N(2),children:"Next"})]})]}):2===y?(0,t.jsxs)("div",{className:"flex flex-col h-full pb-20 overflow-hidden",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Who played?"}),w&&(0,t.jsxs)("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg text-sm mb-4 flex items-center gap-2",children:[(0,t.jsx)(S.Z,{className:"w-4 h-4"}),w]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto no-scrollbar space-y-6 min-h-0",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3 text-emerald-700 font-medium",children:[(0,t.jsx)(n.Z,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:["Select Winners (",h.length,"/","SINGLES"===x?1:2,")"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:a.map(e=>{let a=h.includes(e.id),s=p.includes(e.id);return(0,t.jsx)("button",{disabled:s,onClick:()=>I(e.id,!0),className:"p-3 text-sm rounded-xl border text-left truncate transition-all ".concat(a?"bg-emerald-600 border-emerald-600 text-white shadow-md":s?"bg-gray-50 border-gray-100 text-gray-300 cursor-not-allowed":"bg-white border-gray-200 text-gray-700 hover:border-emerald-200"),children:e.name},"win-".concat(e.id))})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3 text-red-500 font-medium",children:[(0,t.jsx)(C.Z,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:["Select Losers (",p.length,"/","SINGLES"===x?1:2,")"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:a.map(e=>{let a=p.includes(e.id),s=h.includes(e.id);return(0,t.jsx)("button",{disabled:s,onClick:()=>I(e.id,!1),className:"p-3 text-sm rounded-xl border text-left truncate transition-all ".concat(a?"bg-red-500 border-red-500 text-white shadow-md":s?"bg-gray-50 border-gray-100 text-gray-300 cursor-not-allowed":"bg-white border-gray-200 text-gray-700 hover:border-red-200"),children:e.name},"lose-".concat(e.id))})})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex gap-3",children:[(0,t.jsx)(v,{variant:"secondary",className:"flex-1",onClick:()=>N(1),children:"Back"}),(0,t.jsx)(v,{className:"flex-1",onClick:()=>G()&&N(3),children:"Next"})]})]}):(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Final Score"}),w&&(0,t.jsxs)("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg text-sm mb-4 flex items-center gap-2",children:[(0,t.jsx)(S.Z,{className:"w-4 h-4"}),w]}),"confirmed"===T&&(0,t.jsxs)("div",{className:"bg-emerald-50 text-emerald-600 p-3 rounded-lg text-sm mb-4 flex items-center gap-2",children:[(0,t.jsx)(E.Z,{className:"w-4 h-4"}),"Match recorded on blockchain!"]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm mb-6",children:[(0,t.jsx)(k,{autoFocus:!0,label:"Score (e.g. 11-7, 11-9)",placeholder:"11-7, 11-9",value:b,onChange:e=>j(e.target.value),disabled:L}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:'Tip: You can enter anything descriptive, like "3-0" or "Won by knockout".'})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl mb-6",children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Summary"}),(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsx)("span",{className:"text-emerald-700 font-medium",children:"Winners"}),(0,t.jsx)("span",{className:"text-gray-900",children:h.map(e=>{var s;return null===(s=a.find(a=>a.id===e))||void 0===s?void 0:s.name}).join(", ")})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-red-500 font-medium",children:"Losers"}),(0,t.jsx)("span",{className:"text-gray-900",children:p.map(e=>{var s;return null===(s=a.find(a=>a.id===e))||void 0===s?void 0:s.name}).join(", ")})]})]}),"pending"===T&&(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-xl mb-6 text-center",children:[(0,t.jsx)(i.Z,{className:"w-6 h-6 animate-spin text-blue-600 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-blue-700",children:"Recording match on Sepolia blockchain..."}),(0,t.jsx)("p",{className:"text-xs text-blue-500",children:"This may take a few seconds"})]}),(0,t.jsxs)("div",{className:"mt-auto flex gap-3",children:[(0,t.jsx)(v,{variant:"secondary",className:"flex-1",onClick:()=>N(2),disabled:L,children:"Back"}),(0,t.jsxs)(v,{className:"flex-1 flex items-center justify-center gap-2",onClick:U,disabled:L,children:[L&&(0,t.jsx)(i.Z,{className:"w-4 h-4 animate-spin"}),L?"Recording...":"Confirm Match"]})]})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center bg-white rounded-2xl shadow-sm",children:[(0,t.jsx)(d.Z,{className:"w-12 h-12 text-gray-300 mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"You need to sign in to log matches."}),(0,t.jsx)(v,{onClick:r,children:"Go Back"})]})},G=e=>{let{onPlayerAdded:a,onCancel:s}=e,{user:r,getToken:n}=(0,g.a)(),[d,c]=(0,l.useState)(""),[o,x]=(0,l.useState)(null),[m,h]=(0,l.useState)(!1),[u,p]=(0,l.useState)("idle"),f=async e=>{if(e.preventDefault(),!d.trim()){x("Name is required");return}if(!r){x("You must be signed in to add players");return}h(!0),p("pending"),x(null);try{let e=await n();if(!e)throw Error("Failed to get authentication token");await R(d,e),p("confirmed"),setTimeout(()=>{a()},1500)}catch(e){x(e.message||"Failed to create player. Please try again."),p("idle"),h(!1)}};return r?(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"New Player"}),(0,t.jsxs)("form",{onSubmit:f,className:"flex flex-col gap-4",children:[(0,t.jsx)(k,{label:"Player Name",placeholder:"e.g. Forrest Gump",value:d,onChange:e=>{c(e.target.value),x(null)},autoFocus:!0,disabled:m}),o&&(0,t.jsxs)("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg text-sm flex items-center gap-2",children:[(0,t.jsx)(S.Z,{className:"w-4 h-4"}),o]}),"confirmed"===u&&(0,t.jsxs)("div",{className:"bg-emerald-50 text-emerald-600 p-3 rounded-lg text-sm flex items-center gap-2",children:[(0,t.jsx)(E.Z,{className:"w-4 h-4"}),"Player registered on blockchain!"]}),(0,t.jsx)("div",{className:"bg-emerald-50 p-4 rounded-xl text-emerald-800 text-sm",children:(0,t.jsxs)("p",{children:["New players start with a rating of ",(0,t.jsx)("strong",{children:"1200 Elo"}),"."]})}),"pending"===u&&(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-xl text-center",children:[(0,t.jsx)(i.Z,{className:"w-6 h-6 animate-spin text-blue-600 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-blue-700",children:"Registering player on Sepolia blockchain..."}),(0,t.jsx)("p",{className:"text-xs text-blue-500",children:"This may take a few seconds"})]}),(0,t.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,t.jsx)(v,{type:"button",variant:"secondary",className:"flex-1",onClick:s,disabled:m,children:"Cancel"}),(0,t.jsxs)(v,{type:"submit",className:"flex-1 flex items-center justify-center gap-2",disabled:m,children:[m&&(0,t.jsx)(i.Z,{className:"w-4 h-4 animate-spin"}),m?"Creating...":"Create Player"]})]})]})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center bg-white rounded-2xl shadow-sm",children:[(0,t.jsx)(S.Z,{className:"w-12 h-12 text-gray-300 mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"You need to sign in to add players."}),(0,t.jsx)(v,{onClick:s,children:"Go Back"})]})};function U(){let{user:e,loading:a}=(0,g.a)(),[s,r]=(0,l.useState)("leaderboard"),[n,d]=(0,l.useState)([]),[c,o]=(0,l.useState)([]),[x,m]=(0,l.useState)(!1),[h,f]=(0,l.useState)(!1),[b,j]=(0,l.useState)(!1),N=async()=>{m(!0);try{let e=await T();d(e.players),o(e.matches)}catch(e){console.error("Failed to load data",e),d(Z),o(L)}finally{m(!1)}};return((0,l.useEffect)(()=>{a||N()},[a]),h)?(0,t.jsx)("div",{className:"fixed inset-0 bg-gray-50 z-50 flex flex-col max-w-md mx-auto shadow-2xl",children:(0,t.jsx)("div",{className:"flex-1 p-6 overflow-hidden min-h-0",children:(0,t.jsx)(I,{players:n,onMatchLogged:()=>{d(Z),o(L),f(!1),r("leaderboard"),N()},onCancel:()=>f(!1)})})}):b?(0,t.jsx)("div",{className:"fixed inset-0 bg-gray-50 z-50 flex flex-col max-w-md mx-auto shadow-2xl",children:(0,t.jsx)("div",{className:"flex-1 p-6 overflow-hidden min-h-0",children:(0,t.jsx)(G,{onPlayerAdded:()=>{d(Z),j(!1),N()},onCancel:()=>j(!1)})})}):(0,t.jsx)(u,{activeTab:s,onTabChange:r,onOpenAddPlayer:()=>j(!0),onOpenLogMatch:()=>f(!0),children:(x||a)&&0===n.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-emerald-600",children:[(0,t.jsx)(i.Z,{className:"w-8 h-8 animate-spin mb-2"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:a?"Checking authentication...":"Loading data..."})]}):(0,t.jsxs)(t.Fragment,{children:["leaderboard"===s&&(0,t.jsx)(p,{players:n}),"history"===s&&(0,t.jsx)(y,{matches:c,players:n}),"info"===s&&(0,t.jsx)(w,{})]})})}},8774:function(e,a,s){"use strict";s.d(a,{AuthProvider:function(){return p},a:function(){return f}});var t=s(7437),l=s(2265),r=s(738),n=s(4752),i=s(5978);let d=0===(0,r.C6)().length?(0,r.ZF)({apiKey:"AIzaSyDeh4JbRjhp8Hq7Nu_PNomV7hNgxxxHRK8",authDomain:"ns-pong.firebaseapp.com",projectId:"ns-pong",storageBucket:"ns-pong.firebasestorage.app",messagingSenderId:"989309040638",appId:"1:989309040638:web:277e87ced7c9ef2adf32af"}):(0,r.C6)()[0],c=(0,n.v0)(d);(0,i.ad)(d);let o=new n.hJ;o.setCustomParameters({prompt:"select_account"});let x=async()=>{try{return(await (0,n.rh)(c,o)).user}catch(e){throw console.error("Error signing in with Google:",e),e}},m=async()=>{try{await (0,n.w7)(c)}catch(e){throw console.error("Error signing out:",e),e}},h=e=>(0,n.Aj)(c,e),g=async()=>{let e=c.currentUser;return e?e.getIdToken():null},u=(0,l.createContext)(void 0);function p(e){let{children:a}=e,[s,r]=(0,l.useState)(null),[n,i]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=h(e=>{e?r({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL}):r(null),i(!1)});return()=>e()},[]);let d=async()=>{try{i(!0);let e=await x(),a=await e.getIdToken();await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({name:e.displayName,email:e.email,photoURL:e.photoURL})})}catch(e){throw console.error("Sign in error:",e),e}finally{i(!1)}},c=async()=>{try{await m(),r(null)}catch(e){throw console.error("Sign out error:",e),e}},o=async()=>g();return(0,t.jsx)(u.Provider,{value:{user:s,loading:n,signIn:d,signOutUser:c,getToken:o},children:a})}function f(){let e=(0,l.useContext)(u);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[358,533,434,564,971,117,744],function(){return e(e.s=3154)}),_N_E=e.O()}]);